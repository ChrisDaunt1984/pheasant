<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="daizutabi">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Images - Pheasant</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Images";
    var mkdocs_page_input_path = "user-guide\\images.md";
    var mkdocs_page_url = "/user-guide/images/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Pheasant</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">User Guide</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Images</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#image-processing">Image Processing</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#matplotlib">Matplotlib</a></li>
        
            <li><a class="toctree-l4" href="#bokeh">Bokeh</a></li>
        
            <li><a class="toctree-l4" href="#holoviews">HoloViews</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../code/">Code</a>
                </li>
                <li class="">
                    
    <a class="" href="../script/">Script</a>
                </li>
                <li class="">
                    
    <a class="" href="../macro/">Macro</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">About</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../about/release-notes/">Release Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../about/license/">License</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Pheasant</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>User Guide &raquo;</li>
        
      
    
    <li>Images</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="image-processing">Image Processing</h1>
<p>In this section, we study how to embed images created by <a href="https://matplotlib.org/">Matplotlib</a>, <a href="https://bokeh.pydata.org/en/latest/">Bokeh</a>, and <a href="https://holoviews.org/">HoloViews</a> libraries.</p>
<h2 id="matplotlib">Matplotlib</h2>
<p>First, <code>figsize</code> of <code>figure</code> is set to <code>[2, 1.6]</code> to show small figures for saving space.</p>
<pre><code class="python">import matplotlib
import matplotlib.pyplot as plt
matplotlib.rcParams['figure.figsize'] = [2, 1.6]
</code></pre>

<p>A call of <code>plt.plot</code> generates a standard plain text output (a list of <code>Line</code> object in this example) and a PNG image as display data:</p>
<pre><code class="python">plt.plot([1, 3, 5], marker='o')
</code></pre>

<p>If you want to hide the input source and the standard output, you can use a <code>display</code> option to show just the display data such as an image or HTML:</p>
<pre><code class="copy">```python display
plt.plot([4, 2, 3], marker='o')
```
</code></pre>

<p><strong>"Inline code"</strong> is useful to display a plot in shorthand notation. <code>{{#!plt.plot([1, 2, 4])}}</code> generates:</p>
<p>{{!plt.plot([1, 2, 4])}}</p>
<p>Note that the standard plain text output (<code>[&lt;matplotlib.lines...]</code>) is not displayed if the inline code generates display data.</p>
<p>An inline code statement (<code>{{#&lt;expr&gt;}}</code>) can be written in a fenced code block. In this case, the expression in the statement is evaluated dynamically during the evaluation of the fenced code block.</p>
<p>In the next example, two plots are overlayed. <code>axes[0]</code> and <code>axes[1]</code> refer to the same image.</p>
<pre><code class="python">axes = []
for k, color in enumerate(['red', 'blue']):
  plt.plot([1, k + 3], color)
  axes.append(plt.gca())
axes
</code></pre>

<p>You can use the inline code to get different images at the every evaluation time while the iteration is going. You have to call <code>plt.cla()</code> method to continuously clear the previous plot.</p>
<pre><code class="copy">```python hide inline
axes = []
for k, color in enumerate(['red', 'blue']):
    plt.plot([0, k + 3], color)
    axes.append({{plt.gca()}})
    plt.cla()
```
</code></pre>

<p>Here, <code>hide</code> option disables the output of plot from the fenced code block, which we don't need now.</p>
<p>Check the type of elements of the variable <code>axes</code>.</p>
<pre><code class="python">[type(ax) for ax in axes]
</code></pre>

<p>They are <code>str</code> objects, not any Matplotlib objects. Actually, their content is a base64-encoded markdown image source:</p>
<pre><code class="python">axes[0][:50]
</code></pre>

<p>Thanks to this Pheasant feature, you can put images anywhere. For example, in a table:</p>
<pre><code class="copy">#Tab A Markdown table with Matplotlib plot
|Red         |Blue       |
|------------|-----------|
|{{axes[0]}} |{{axes[1]}}|
</code></pre>

<p>If you prefer a Pandas DataFrame, HTML-type inline code can be used with <code>{{#^</code> and <code>}}</code>.</p>
<pre><code class="copy">```python hide inline
axes = []
for k, color in enumerate(['red', 'blue']):
    plt.plot([0, k + 3], color)
    axes.append({{^plt.gca()}})
    plt.cla()
```
</code></pre>

<p>Then,</p>
<pre><code class="copy">#Tab A Pandas DataFrame with a Matplotlib plot
```python inline
import pandas as pd
{{pd.DataFrame([axes], columns=['Red', 'Blue'])}}
```
</code></pre>

<h2 id="bokeh">Bokeh</h2>
<p>You can embed <a href="https://bokeh.pydata.org/en/latest/">Bokeh</a>'s plots into MkDocs HTML documents. Following <a href="https://bokeh.pydata.org/en/latest/docs/user_guide/embed.html">User Guide "Embedding Plots and Apps"</a> from the official Bokeh documents, Pheasant automatically adds extra stylesheet and javascript in HTML <code>&lt;head&gt;</code> tag. You don't need to configure <code>extra_css</code> and <code>extra_javascript</code> in your <code>mkdocs.yml</code> manually.</p>
<p>In order to embed plots in your document, <code>bokeh.embed.components</code> function can be used. This function returns <code>&lt;script&gt;</code>  and <code>&lt;div&gt;</code> tags in HTML format. For example:</p>
<pre><code class="python">from bokeh.plotting import figure
from bokeh.embed import components

plot = figure(plot_width=250, plot_height=250)
plot.circle([1, 2, 3, 4, 5], [1, 3, 0, 2, 4], size=10)
script, div = components(plot)
print('[script]:', script[:140].strip(), '...')
print('[div]:', div[:40].strip(), '...')
</code></pre>

<p>These <code>&lt;script&gt;</code>  and <code>&lt;div&gt;</code> tags are used in an inline code like <code>{{#script}}{{#div}}</code> to get a plot as shown below:</p>
<pre><code class="copy">{{script}}{{div}}
</code></pre>

<p>A shortcut to this functionality is prepared.</p>
<pre><code class="copy">{{plot}}
</code></pre>

<p>Just for your infomation, the extra stylesheet and javascript files provided by Bokeh are obtained by the following commands.</p>
<pre><code class="python">from bokeh.resources import CDN
CDN.css_files
</code></pre>

<pre><code class="python">CDN.js_files
</code></pre>

<p>In fact, Pheasant uses the above API to embed Bokeh's plots internally.</p>
<h2 id="holoviews">HoloViews</h2>
<p>HoloViews provides an explorable multi-dimensional dictionary of HoloViews objects called <a href="https://holoviews.org/reference/containers/bokeh/HoloMap.html">HoloMap</a>. Pheasant can also embed this interactive object in your MkDocs Documents as well as other HoloViews objects.</p>
<p>First, a normal HoloViews object.</p>
<pre><code class="copy">```python
import holoviews as hv
curve = hv.Curve(([1, 2, 3], [2, 3, 1]))
curve
```
</code></pre>

<pre><code class="python">type(curve)
</code></pre>

<p>As you can see, HoloView's <code>Curve</code> object doesn't supply any visual representation. To get a HTML source to visualize it, we have to render the object.</p>
<pre><code class="python">renderer = hv.renderer('bokeh')
html = renderer.html(curve)
print(html[:40], '...')
</code></pre>

<p>Extra assets which should be written in HTML <code>&lt;head&gt;</code> tag to display the image are provided by the <code>renderer</code>'s class method: <code>html_assets()</code>.</p>
<pre><code class="python">js_html, css_html = renderer.html_assets()
print(js_html.strip()[:50])
</code></pre>

<pre><code class="python">print(css_html.strip()[:50])
</code></pre>

<p>The above process to display a HTML image from a HoloViews object can be done by just an inline code like this.</p>
<pre><code class="copy">{{curve}}
</code></pre>

<p>Showing a HoloMap is straightforward. From HoloViews's official documents,</p>
<pre><code class="python">import numpy as np
frequencies = [0.5, 0.75, 1.0, 1.25]

def sine_curve(phase, freq):
    xvals = [0.1* i for i in range(100)]
    return hv.Curve((xvals, [np.sin(phase+freq*x) for x in xvals]))

curve_dict = {f:sine_curve(0,f) for f in frequencies}
hmap = hv.HoloMap(curve_dict, kdims='frequency')
</code></pre>

<pre><code class="copy">{{hmap}}
</code></pre>

<pre><code class="python">phases = [0, np.pi/2, np.pi, 3*np.pi/2]
curve_dict_2D = {(p,f):sine_curve(p,f) for p in phases for f in frequencies}
hmap = hv.HoloMap(curve_dict_2D, kdims=['phase', 'frequency'])
</code></pre>

<pre><code class="copy">{{hmap}}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../code/" class="btn btn-neutral float-right" title="Code">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../.." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/daizutabi/pheasant/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../.." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../code/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>

</body>
</html>
